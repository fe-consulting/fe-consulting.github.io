{"data":{"markdownRemark":{"html":"<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*E4fL_rwjpkvWwqHXEHi7eg.png\"></p>\n<p>If like me you also believe everything should be immutable, youâ€™ll be happy to see what Typescript 3.4 brings with it.Â </p>\n<p>While just about everything seems great, the thing that caught my attention the most, simply because itâ€™s still one of the most common errors I see in Javascript code, is the introduction of <code class=\"language-text\">ReadonlyArray</code>, which helps us prevent array mutations at compile time.</p>\n<h3 id=\"mutations-are-bad\"><a href=\"#mutations-are-bad\" aria-label=\"mutations are bad permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mutations areÂ bad</h3>\n<p>This is just one of the many reasons why Redux was so popular in the first place. Mutations cause all sorts of issues in our code, and they also happen to be quite difficult bugs to track down.Â </p>\n<p>I see this happening a lot in Angular teams: an array gets passed down to a component, and the child component happens to be sorting this array: what happens? the array mutation propagates all the way up to the parent.</p>\n<p>Consider the snippet below:</p>\n<ul>\n<li>we have a parent component that declares an array of numbers</li>\n<li>we have a child component that takes the input from the parent and calls the method <code class=\"language-text\">reverse()</code></li>\n<li>Result: both arrays get mutated!</li>\n</ul>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*ZP_eeKmaHEbcYPWBtARfgA.png\"></p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*D-HsVFalib8C2Y2piN99JA.png\"></p>\n<p>These sort of mistakes cost me hours and hours during my career, often mistakes made by me.Â </p>\n<p>But lately, these are bugs I have fixed for code that was already there, as I finally learned how to **never mutate an object or an array.Â **</p>\n<p>The thing is, sometimes it can still happen.</p>\n<h3 id=\"readonlyarray-to-the-rescue\"><a href=\"#readonlyarray-to-the-rescue\" aria-label=\"readonlyarray to the rescue permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ReadonlyArray to theÂ rescue</h3>\n<p>How does Typescriptâ€™s <code class=\"language-text\">ReadonlyArray</code> help us in minimizing this sort of errors? Check the image below:</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*tQN4h0mG5UOuXrFmATysaQ.png\"></p>\n<p>As you can see, the compiler warns us thereâ€™s a mistake, as the interface <code class=\"language-text\">ReadonlyArray</code> does not contain the method <code class=\"language-text\">reverse</code> ðŸŽ‰</p>\n<p>As weird as it sounds, I love being told I am making a mistake. Itâ€™s why I like Typescript so much.</p>\n<p>Letâ€™s see what the compiler tells us about different operations on read-only arrays:</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*gpRDv-jSUP43mMprl-k8ng.png\"></p>\n<p>As you can see, reverse, sort, splice, push are all methods that mutate the arrayâ€Šâ€”â€Šso we better avoid using them.Â </p>\n<p>Other methods, such as <code class=\"language-text\">filter</code>, <code class=\"language-text\">concat</code>, <code class=\"language-text\">reduce</code>, etc. are immutable, and should always be preferred.</p>\n<p>Do your future-self, or whoever is going to pick up your code one day, a small favour: use <code class=\"language-text\">Readonly</code>.</p>","frontmatter":{"title":"Why you'll love Typescript's ReadonlyArray","date":"30.04.2019","category":"typescript"},"timeToRead":2}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/why-youll-love-typescripts-readonly-array","prev":{"fields":{"slug":"/frameworks-dont-magically-make-your-code-good"},"frontmatter":{"title":"Frameworks don't magically make your codeÂ good","category":"software-engineering"}},"next":{"fields":{"slug":"/enforce-your-team-coding-style-with-prettier-and-ts-lint"},"frontmatter":{"title":"Enforce your team coding style with Prettier andÂ TsLint","category":"software-engineering"}}}}