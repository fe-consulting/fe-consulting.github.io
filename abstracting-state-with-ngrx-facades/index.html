<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:87.5%/1.66 '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:3.157rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.99326rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.58383rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.79459rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.7083rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}ul{margin-left:1.66rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.66rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;font-size:0.85rem;line-height:1.66rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;font-size:1rem;line-height:1.66rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}blockquote{margin-left:1.66rem;margin-right:1.66rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.66rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.66rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.66rem;margin-bottom:calc(1.66rem / 2);margin-top:calc(1.66rem / 2);}li > ul{margin-left:1.66rem;margin-bottom:calc(1.66rem / 2);margin-top:calc(1.66rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.66rem / 2);}code{font-size:0.85rem;line-height:1.66rem;}kbd{font-size:0.85rem;line-height:1.66rem;}samp{font-size:0.85rem;line-height:1.66rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.10667rem;padding-right:1.10667rem;padding-top:0.83rem;padding-bottom:calc(0.83rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><style data-href="/styles.6b6fe26ad64f70a91fb9.css">code[class*=language-],pre[class*=language-]{font-family:Consolas,Menlo,Monaco,Andale Mono WT,Andale Mono,Lucida Console,Lucida Sans Typewriter,DejaVu Sans Mono,Bitstream Vera Sans Mono,Liberation Mono,Nimbus Mono L,Courier New,Courier,monospace;font-size:14px;line-height:1.375;direction:ltr;background:#f5f7ff;color:#5e6687}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#dfe2f1}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#dfe2f1}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#898ea4}.token.punctuation{color:#5e6687}.token.namespace{opacity:.7}.token.boolean,.token.number,.token.operator{color:#c76b29}.token.property{color:#c08b30}.token.tag{color:#3d8fd1}.token.string{color:#22a2c9}.token.selector{color:#6679cc}.token.attr-name{color:#c76b29}.language-css .token.string,.style .token.string,.token.entity,.token.url{color:#22a2c9}.token.attr-value,.token.control,.token.directive,.token.keyword,.token.unit{color:#ac9739}.token.atrule,.token.regex,.token.statement{color:#22a2c9}.token.placeholder,.token.variable{color:#3d8fd1}.token.deleted{text-decoration:line-through}.token.inserted{border-bottom:1px dotted #202746;text-decoration:none}.token.important{color:#c94922}pre>code.highlight{outline:.4em solid #c94922;outline-offset:.4em}.line-numbers .line-numbers-rows{border-right-color:#dfe2f1}.line-numbers-rows>span:before{color:#979db4}.line-highlight{background:rgba(107,115,148,.2);background:-webkit-gradient(linear,left top,right top,color-stop(70%,rgba(107,115,148,.2)),to(rgba(107,115,148,0)));background:linear-gradient(90deg,rgba(107,115,148,.2) 70%,rgba(107,115,148,0))}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.3.22"/><title data-react-helmet="true">Abstracting State with NGRX Facades | Frontend Consulting | Typescript, Angular, NGRX and Rxjs</title><link data-react-helmet="true" rel="canonical" href="https://frontend.consulting/abstracting-state-with-ngrx-facades"/><meta data-react-helmet="true" name="description"/><meta data-react-helmet="true" name="keywords" content="Frontend Consulting for Angular, RxJS, Typescript, NGRX"/><meta data-react-helmet="true" name="image" content="https://cdn-images-1.medium.com/max/1600/1*TggmpinSAPh1ndMBoTj0bw.png"/><meta data-react-helmet="true" property="og:locale" content="de_DE"/><meta data-react-helmet="true" property="og:site_name"/><meta data-react-helmet="true" property="og:url" content="https://frontend.consulting/abstracting-state-with-ngrx-facades"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Abstracting State with NGRX Facades"/><meta data-react-helmet="true" property="og:description"/><meta data-react-helmet="true" property="og:image" content="https://cdn-images-1.medium.com/max/1600/1*TggmpinSAPh1ndMBoTj0bw.png"/><meta data-react-helmet="true" property="fb:app_id" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="gc_psk"/><meta data-react-helmet="true" name="twitter:title" content="Abstracting State with NGRX Facades"/><meta data-react-helmet="true" name="twitter:url" content="https://frontend.consulting"/><meta data-react-helmet="true" name="twitter:description"/><meta data-react-helmet="true" name="twitter:image" content="https://cdn-images-1.medium.com/max/1600/1*TggmpinSAPh1ndMBoTj0bw.png"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://frontend.consulting/","name":"Frontend Consulting | Typescript, Angular, NGRX and Rxjs","alternateName":"Frontend Consulting"}]</script><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://frontend.consulting/","name":"Abstracting State with NGRX Facades","alternateName":"Frontend Consulting"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://frontend.consulting/abstracting-state-with-ngrx-facades","name":"Abstracting State with NGRX Facades","image":"https://cdn-images-1.medium.com/max/1600/1*TggmpinSAPh1ndMBoTj0bw.png"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://frontend.consulting/","name":"Abstracting State with NGRX Facades","alternateName":"Frontend Consulting","headline":"Abstracting State with NGRX Facades","image":{"@type":"ImageObject","url":"https://cdn-images-1.medium.com/max/1600/1*TggmpinSAPh1ndMBoTj0bw.png"}}]</script><style data-styled-components="iYAehQ bkrTGl iqyGec dhCPRd bLlJxD bLskdq jxVsqx QwWss cSfUzs dstUWH VLDzk bULfeK">
/* sc-component-id: Header__Heading-beimjb-0 */
.bkrTGl{font-size:18px;font-weight:500;margin:0;padding:0.5rem 0;font-family:'Raleway',sans-serif;} .bkrTGl a:hover{border-color:transparent;}
/* sc-component-id: Header__Navigation-beimjb-1 */
.iqyGec{-webkit-flex:1;-ms-flex:1;flex:1;-webkit-align-items:end;-webkit-box-align:end;-ms-flex-align:end;align-items:end;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;line-height:15px;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;} .iqyGec a{font-weight:300;font-size:18px;margin-left:2rem;border-bottom:3px solid transparent;padding:0.5rem 0;-webkit-transition:border 0.25s;transition:border 0.25s;font-family:'Raleway',sans-serif;} .iqyGec a:hover,.iqyGec [aria-current],.iqyGec .current{border-bottom-color:#64b5f6;}
/* sc-component-id: Header__FlexHeader-beimjb-2 */
.iYAehQ{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;max-width:1140px;margin:0 auto;padding:1rem 3rem;} @media (max-width:600px){.iYAehQ{padding:20px;}}
/* sc-component-id: sc-global-1697483289 */
@import url('https://fonts.googleapis.com/css?family=Raleway:100,400,600'); body{color:#212121;background:#fafafa;font-family:'Raleway',sans-serif;} @media (max-width:600px){body{font-size:14px;}} body::selection,body::-moz-selection{background:#fafafa;} a{color:#212121;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:all 0.5s;transition:all 0.5s;border-bottom:1px solid transparent;} a:hover{border-color:#64b5f6;color:#212121;} h1,h2,h3,h4{color:#212121;} blockquote{font-style:italic;position:relative;} blockquote:before{content:"";position:absolute;background:#64b5f6;height:100%;width:6px;margin-left:-1.6rem;} label{margin-bottom:.5rem;color:rgba(0,0,0,0.9);} input,textarea{border-radius:.5rem;border:none;background:rgba(0,0,0,0.05);padding:.25rem 1rem;} input:focus,textarea:focus{outline:none;}
/* sc-component-id: Layout__Footer-sc-1883uv5-0 */
.bULfeK{text-align:center;padding:0;} .bULfeK a{padding:0 1rem;} .bULfeK span{font-size:0.75rem;}
/* sc-component-id: PrevNext__Wrapper-a8usab-0 */
.dstUWH{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:6rem auto 0 auto;justify-items:center;} .dstUWH a{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
/* sc-component-id: PrevNext__Next-a8usab-2 */
.VLDzk{margin-left:auto;text-align:right;} .VLDzk span{text-transform:uppercase;font-size:0.8rem;}
/* sc-component-id: Subline-sc-1oopd01-0 */
.jxVsqx{font-size:0.9rem;}
/* sc-component-id: Wrapper-sc-132nl7e-0 */
.dhCPRd{display:grid;grid-template-columns:1fr minmax(320px,1140px) 1fr;padding:0 1rem;}
/* sc-component-id: Content-sgn00h-0 */
.bLlJxD{grid-column:2;padding:1rem 3rem;overflow:hidden;} @media (max-width:1200px){.bLlJxD{padding:3rem 2rem;}} @media (max-width:600px){.bLlJxD{padding:2rem 0.5rem;}}
/* sc-component-id: post__Title-sc-12e8ad-0 */
.bLskdq{margin-bottom:1rem;font-weight:100;}
/* sc-component-id: post__FeaturedImage-sc-12e8ad-1 */
.QwWss{width:800px;height:auto;margin-top:2rem;}
/* sc-component-id: post__PostContent-sc-12e8ad-2 */
.cSfUzs{font-size:18px;font-weight:300;font-family:'Merriweather',serif;line-height:2;width:100%;max-width:800px;margin-top:0em;} .cSfUzs a[target='_blank']{border-bottom:1px solid #64b5f6;padding-bottom:2px;} .cSfUzs p,.cSfUzs pre{margin-top:1.66rem;}
/* sc-component-id: sc-global-1250939217 */
@import url('https://fonts.googleapis.com/css?family=Merriweather:300,400,700');</style><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link href="//fonts.googleapis.com/css?family=-apple-system,+BlinkMacSystemFont,+&quot;Segoe+UI&quot;,+Roboto,+Helvetica,+Arial,+sans-serif,+&quot;Apple+Color+Emoji&quot;,+&quot;Segoe+UI+Emoji&quot;,+&quot;Segoe+UI+Symbol&quot;;:700|-apple-system,+BlinkMacSystemFont,+&quot;Segoe+UI&quot;,+Roboto,+Helvetica,+Arial,+sans-serif,+&quot;Apple+Color+Emoji&quot;,+&quot;Segoe+UI+Emoji&quot;,+&quot;Segoe+UI+Symbol&quot;;:400" rel="stylesheet" type="text/css"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#64b5f6"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=7cff4860a51e9c0056df4ff0963a38d7"/><link rel="alternate" type="application/rss+xml" title="Frontend Consulting Blog RSS Feed" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-139a1d28608ef417313a.js"/><link as="script" rel="preload" href="/app-e90d4623df6422be07b9.js"/><link as="script" rel="preload" href="/styles-946161ed1295301d6b25.js"/><link as="script" rel="preload" href="/0-018b23dab0eba863196b.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-1d33f3440efcc6e0648b.js"/><link as="fetch" rel="preload" href="/static/d/703/path---abstracting-state-with-ngrx-facades-01-c-a5b-Z1xqaoX8mN4KtNbY84ry0o23aA.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div class="Header__FlexHeader-beimjb-2 iYAehQ"><h1 class="Header__Heading-beimjb-0 bkrTGl"><a href="/">frontend.consulting</a></h1><div class="Header__Navigation-beimjb-1 iqyGec"><a href="/articles">articles</a><a href="mailto:gc@frontend.consulting">get in touch</a></div></div><div class="Wrapper-sc-132nl7e-0 dhCPRd"><div class="Content-sgn00h-0 bLlJxD"><h1 class="post__Title-sc-12e8ad-0 bLskdq">Abstracting State with NGRX Facades</h1><div class="Subline-sc-1oopd01-0 jxVsqx">27.05.2019<!-- --> — <!-- -->12<!-- --> Min Read — In<!-- --> <a href="/categories/angular">angular</a></div><img class="post__FeaturedImage-sc-12e8ad-1 QwWss" alt="Abstracting State with NGRX Facades" src="https://cdn-images-1.medium.com/max/1600/1*TggmpinSAPh1ndMBoTj0bw.png"/><div class="post__PostContent-sc-12e8ad-2 cSfUzs"><p>This is the fourth and last article of a series that aims to explain in detail a step-by-step approach to building an Angular application with NGRX.</p>
<ul>
<li>In <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fstate-management-with-ngrx-introduction-1aae0803e988" target="_blank" rel="nofollow noopener noreferrer">the first article of this series</a>, I wrote a small overview of all the concepts surrounding the NGRX platform.</li>
<li>In <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Farchitecting-the-store-in-ngrx-e4955641d746" target="_blank" rel="nofollow noopener noreferrer">the second article of this series</a>, I started writing the store of the application and the state’s entities.</li>
<li>In <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fbuilding-side-effects-in-ngrx-deb0d856096d" target="_blank" rel="nofollow noopener noreferrer">the third article of this series</a>, we built the effects that are responsible for fetching assets and prices from Coincap’s API</li>
</ul>
<h3 id="summary"><a href="#summary" aria-label="summary permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Summary</h3>
<p>Just to summarise what I introduced in the previous articles, we have an application that aims to display a dashboard with cryptocurrencies prices.</p>
<p>The application’s logic is built using three service modules, each module manages a different feature of our store.</p>
<p>These are:</p>
<ul>
<li><strong>dashboard</strong>, that manages the logic of the dashboard and its tiles</li>
<li><strong>assets,</strong> a list of assets fetched from <a href="https://medium.com/r/?url=https%3A%2F%2Fcoincap.io" target="_blank" rel="nofollow noopener noreferrer">Coincap’s</a> API</li>
<li><strong>prices,</strong> a stream of prices from Coincap’s WebSocket API</li>
</ul>
<p><strong>What the app will look like:</strong></p>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*R3-0VFvXB2rq-rAtWyNwxA.gif"></p>
<p>Type caption for image (optional)  </p>
<h3 id="in-this-article-we-will-be-learning"><a href="#in-this-article-we-will-be-learning" aria-label="in this article we will be learning permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>In this article we will be learning:</h3>
<ul>
<li>what a Facade service is and how we apply it to NGRX</li>
<li>creating lean UI components that are connected with the <em>Store</em> using <strong>Facades</strong></li>
</ul>
<h2 id="whats-a-facade"><a href="#whats-a-facade" aria-label="whats a facade permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s a Facade?</h2>
<p>A <em>Facade</em>, in terms of software engineering, is implemented as an object that offers a unified and simpler interface behind a more complex system. </p>
<p>In other terms, it abstracts the complex system (<em>NGRX</em>) behind a single <em>Service</em>.</p>
<p>How is that useful for us?</p>
<ul>
<li>we abstract UI components from the State Management used</li>
<li>we simplify the interfaces using clear, small methods</li>
<li>we minimize the number of dependencies used by a component</li>
<li>we provide a central service to fetch data and dispatch commands</li>
</ul>
<h3 id="advantages"><a href="#advantages" aria-label="advantages permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Advantages</h3>
<ul>
<li><strong>Abstraction</strong><br>
Let’s say we start this project using <em>NGRX</em> and one day we decide to switch to <em>NGXS</em>, <em>Akita</em>, or some other State Management tooling. By using facades, we never have to refactor components and services that rely on the library used.</li>
<li><strong>Simplicity</strong>
A facade will hide away the technicalities and implementation of the library we use from the consumers, which result in components being lean and simple.</li>
<li><strong>Reusability</strong><br>
A facade will help with reusing some of the code used to dispatch and create actions, or select fragments from the store, as you never need to write that twice.</li>
</ul>
<p>Of course, there are also some disadvantages to using Facade Services with NGRX, and I’d recommend you to the article <a href="https://medium.com/r/?url=https%3A%2F%2Fauth0.com%2Fblog%2Fngrx-facades-pros-and-cons%2F" target="_blank" rel="nofollow noopener noreferrer">NgRx Facades: Pros and Cons</a> for a great explanation.</p>
<h2 id="facade-services-in-practice"><a href="#facade-services-in-practice" aria-label="facade services in practice permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Facade Services in Practice</h2>
<p>But now, let’s get back to our application and apply what we learned about Facades.</p>
<p>We will be implementing a Facade Service for each of our Store Modules we built in the previous articles. </p>
<p>The Facade Service will be the interface between the modules that import the Store Modules and their internal smart components.</p>
<p>The only Feature Module we need to build is going to be the Dashboard Feature Module that will take care of defining the UI containers and components that will be connected via our Facade Services exported from the Store Modules. </p>
<p>We will build 4 components:</p>
<ul>
<li><strong>Dashboard component,</strong> that will query the store for the assets that have been subscribed. Initially, no asset is selected.</li>
<li><strong>Tile component,</strong> that will  contain an asset selector if no asset for that tile has been subscribed, otherwise, it will display an asset pricer if instead the user subscribed to an asset</li>
<li><strong>Asset selector,</strong> that the user can use to select an asset (ex. Bitcoin)</li>
<li><strong>Asset pricer,</strong> that will display the prices of the asset selected</li>
</ul>
<p>A few things before we start:</p>
<ul>
<li>These components will be powered by <a href="https://medium.com/r/?url=https%3A%2F%2Fmaterial.angular.io%2F" target="_blank" rel="nofollow noopener noreferrer">Angular Material</a></li>
<li>All imports are omitted for brevity, but the link to the source code will be provided</li>
</ul>
<h3 id="dashboard-component"><a href="#dashboard-component" aria-label="dashboard component permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Dashboard Component</h3>
<p>The Dashboard component will be responsible for 2 things:</p>
<ul>
<li>loading the assets when initialized, using the <em>Assets Facade</em></li>
<li>querying and displaying all the tiles from the store, using the <em>Dashboard Facade</em></li>
</ul>
<p>Before we build the component, let’s take a look at the Facades. </p>
<p>We first create the <strong>Dashboard Facade</strong>:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DashboardFacadeServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">DashboardFacadeService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> tiles$<span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span>Tile<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>selectAllTiles<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> store<span class="token punctuation">:</span> Store<span class="token operator">&lt;</span>EntityAdapter<span class="token operator">&lt;</span>Tile<span class="token operator">>></span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">addTile</span><span class="token punctuation">(</span><span class="token parameter">payload<span class="token punctuation">:</span> Tile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addTile</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">updateTileAsset</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> assetId<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">updateTileAsset</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> assetId <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Let’s break it down:</p>
<ul>
<li><strong>tiles$</strong> is an Observable that selects all the tiles from the store</li>
<li>we have two methods, <strong>addTile,</strong> and <strong>updateTileAsset,</strong> that will dispatch actions to the store for adding and updating a tile</li>
</ul>
<p>We first create the <strong>Assets Facade</strong>:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AssetsFacadeImplService</span> <span class="token keyword">implements</span> <span class="token class-name">AssetsFacadeService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> assets$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>selectAllAssets<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> store<span class="token punctuation">:</span> Store<span class="token operator">&lt;</span>EntityState<span class="token operator">&lt;</span>Asset<span class="token operator">>></span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>
            <span class="token function">getAssetsRequestStarted</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                payload<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This one is very simple, we have:</p>
<ul>
<li>the list of assets selected from the store</li>
<li>an action dispatched to the effects to fetch the assets using the API</li>
</ul>
<p>And now on to the UI side of things. We define the Dashboard Component’s controller, which will use the two Facades we defined above:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token punctuation">:</span> <span class="token string">'cf-dashboard'</span><span class="token punctuation">,</span>
    templateUrl<span class="token punctuation">:</span> <span class="token string">'./dashboard.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'./dashboard.component.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    changeDetection<span class="token punctuation">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DashboardComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> tiles$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dashboardFacade<span class="token punctuation">.</span>tiles$<span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token keyword">private</span> dashboardFacade<span class="token punctuation">:</span> DashboardFacadeService<span class="token punctuation">,</span>
        <span class="token keyword">private</span> assetsFacade<span class="token punctuation">:</span> AssetsFacadeService</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>assetsFacade<span class="token punctuation">.</span><span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">addTile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dashboardFacade<span class="token punctuation">.</span><span class="token function">addTile</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Tile</span><span class="token punctuation">(</span>undefined<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>The template of the component will display the tiles using a Grid List component from Angular Material</li>
<li>Every tile’s state is passed to the component <strong>cf-tile</strong></li>
<li>A button (<code class="language-text">mat-icon-button</code>) is displayed in its own tile and is used to add a new empty tile</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-grid-list</span>
    <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span>
    <span class="token attr-name">rowHeight</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2:1<span class="token punctuation">"</span></span>
    <span class="token attr-name">gutterSize</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15px<span class="token punctuation">"</span></span>
    <span class="token attr-name">*ngIf</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tiles$ | async as tiles<span class="token punctuation">"</span></span>
<span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ng-container</span> <span class="token attr-name">*ngFor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>let tile of tiles<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-grid-tile</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pricer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cf-tile</span> <span class="token attr-name">[tile]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cf-tile</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-grid-tile</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ng-container</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-grid-tile</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">mat-icon-button</span> <span class="token attr-name">(click)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>addTile()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-icon</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>accent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-icon</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-grid-tile</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-grid-list</span><span class="token punctuation">></span></span></code></pre></div>
<h3 id="tile-component"><a href="#tile-component" aria-label="tile component permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tile Component</h3>
<p>The tile component is responsible for displaying either the assets dropdown or the asset price if any has been subscribed. This component is going to need two facades:</p>
<ul>
<li>the dashboard facade, that we defined earlier</li>
<li>the prices facade, in order to create a subscription once an asset has been selected</li>
</ul>
<p>Let’s move on and define the Pricer Facade:</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PricesFacadeServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">PricesFacadeService</span> <span class="token punctuation">{</span>
    subscribedAssets$<span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>
        selectSubscribedAssets
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> store<span class="token punctuation">:</span> Store<span class="token operator">&lt;</span>EntityState<span class="token operator">&lt;</span>PriceState<span class="token operator">>></span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">createPriceSubscription</span><span class="token punctuation">(</span><span class="token parameter">assetId<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addInitialPrice</span><span class="token punctuation">(</span>assetId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createSubscription</span><span class="token punctuation">(</span>assetId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">getPriceForAsset</span><span class="token punctuation">(</span>assetId<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">selectPriceForAsset</span><span class="token punctuation">(</span>assetId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">addInitialPrice</span><span class="token punctuation">(</span><span class="token parameter">assetId<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addPrice</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>assetId<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">''</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token function">createSubscription</span><span class="token punctuation">(</span><span class="token parameter">assetId<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">createPriceSubscription</span><span class="token punctuation">(</span><span class="token punctuation">{</span> payload<span class="token punctuation">:</span> assetId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now, let’s break what we’ve defined down:</p>
<ul>
<li>we define two private methods for dispatching actions: the method <code class="language-text">addInitalPrice</code> will create the initial price for the asset subscribed, which is initially empty; the other method <code class="language-text">createSubscription</code> will start the WebSocket subscription, as we’ve seen <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fbuilding-side-effects-in-ngrx-deb0d856096d" target="_blank" rel="nofollow noopener noreferrer">in the previous article</a> when we defined the effects.</li>
</ul>
<p>The Tile component is very simple: </p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token punctuation">:</span> <span class="token string">'cf-tile'</span><span class="token punctuation">,</span>
    templateUrl<span class="token punctuation">:</span> <span class="token string">'./tile.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'./tile.component.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    changeDetection<span class="token punctuation">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TileComponent</span> <span class="token punctuation">{</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> tile<span class="token punctuation">:</span> Tile<span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span>
        <span class="token parameter"><span class="token keyword">private</span> dashboardFacade<span class="token punctuation">:</span> DashboardFacadeService<span class="token punctuation">,</span>
        <span class="token keyword">private</span> pricesFacade<span class="token punctuation">:</span> PricesFacadeService</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">updateTile</span><span class="token punctuation">(</span><span class="token parameter">assetId<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dashboardFacade<span class="token punctuation">.</span><span class="token function">updateTileAsset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tile<span class="token punctuation">.</span>id<span class="token punctuation">,</span> assetId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>pricesFacade<span class="token punctuation">.</span><span class="token function">createPriceSubscription</span><span class="token punctuation">(</span>assetId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>In the template, we simply use an <code class="language-text">ngSwitch</code> to either display the price if the <code class="language-text">assetId</code> is defined, or the selector if it is undefined.</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">[ngSwitch]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tile.assetId<span class="token punctuation">"</span></span> <span class="token attr-name">fxLayout</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tile-header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tile-heading<span class="token punctuation">"</span></span> <span class="token attr-name">*ngSwitchDefault</span><span class="token punctuation">></span></span>
            {{ tile.assetId | titlecase }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cf-asset-selector</span>
            <span class="token attr-name">*ngSwitchCase</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>undefined<span class="token punctuation">"</span></span>
            <span class="token attr-name">(assetSelected)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>updateTile($event)<span class="token punctuation">"</span></span>
        <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cf-asset-selector</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tile-content<span class="token punctuation">"</span></span> <span class="token attr-name">fxFlexAlign</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>center center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cf-asset-pricer</span>
           <span class="token attr-name">*ngSwitchDefault</span>
           <span class="token attr-name">[asset]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tile.assetId<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cf-asset-pricer</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p>The component <code class="language-text">cf-asset-selector</code> will dispatch an output when an asset is selected by the user, and the output will call the method <code class="language-text">updateTile</code> , which will update the tile by assigning it an <code class="language-text">assetId</code>, and then will call the method to create the price subscription and start streaming the asset prices.</p>
<h3 id="asset-selector-component"><a href="#asset-selector-component" aria-label="asset selector component permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Asset Selector Component</h3>
<p>The Asset Selector component is simply a dropdown with the available assets that will dispatch an output when an asset has been selected. The assets are queried from the Assets Facade. Simple, right?</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token punctuation">:</span> <span class="token string">'cf-asset-selector'</span><span class="token punctuation">,</span>
    templateUrl<span class="token punctuation">:</span> <span class="token string">'./asset-selector.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'./asset-selector.component.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    changeDetection<span class="token punctuation">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AssetSelectorComponent</span> <span class="token punctuation">{</span>
    @<span class="token function">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span> assetSelected <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> assets$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>assetsFacade<span class="token punctuation">.</span>assets$<span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> assetsFacade<span class="token punctuation">:</span> AssetsFacadeService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>The template is powered by the <code class="language-text">mat-select</code> component from Angular Material, although a simple select would have done the job. We simply create a select and iterate the assets to create the available option. </p>
<p>When an option gets selected, the output <code class="language-text">assetSelected</code> will emit a new event.</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-form-field</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-label</span><span class="token punctuation">></span></span>
        Select Asset
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-label</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-select</span> <span class="token attr-name">(selectionChange)</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>assetSelected.next($event.value)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-option</span> <span class="token attr-name">*ngFor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>let asset of (assets$ | async)<span class="token punctuation">"</span></span> <span class="token attr-name">[value]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>asset.id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            {{ asset.name }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-option</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-select</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-form-field</span><span class="token punctuation">></span></span></code></pre></div>
<h3 id="asset-pricer-component"><a href="#asset-pricer-component" aria-label="asset pricer component permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Asset Pricer Component</h3>
<p>The Asset Pricer component is responsible for displaying the prices, and also show when a price went up or down for 2 seconds. </p>
<p>As you may have noticed, this component is the cool one. We receive an asset ID as input, and we create a subscription to the store for streaming the prices to our component.</p>
<blockquote>
<p>Technically this is a smart component and should have passed the data down to dumb components, but for brevity, I thought it’d be better to show all the code in one single component</p>
</blockquote>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selector<span class="token punctuation">:</span> <span class="token string">'cf-asset-pricer'</span><span class="token punctuation">,</span>
    templateUrl<span class="token punctuation">:</span> <span class="token string">'./asset-pricer.component.html'</span><span class="token punctuation">,</span>
    styleUrls<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'./asset-pricer.component.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    changeDetection<span class="token punctuation">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AssetPricerComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">{</span>
    @<span class="token function">Input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> asset<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> price$<span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> trend$<span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span>Trend<span class="token operator">></span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">readonly</span> trends <span class="token operator">=</span> Trend<span class="token punctuation">;</span>

    <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">private</span> pricesFacade<span class="token punctuation">:</span> PricesFacadeService</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>price$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pricesFacade<span class="token punctuation">.</span><span class="token function">getPriceForAsset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>asset<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
            <span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">price<span class="token punctuation">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">shareReplay</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> timer$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
            <span class="token function">switchMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">mapTo</span><span class="token punctuation">(</span>Trend<span class="token punctuation">.</span>Stale<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> trend$ <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>price$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
            <span class="token function">pairwise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prices<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> prices<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!==</span> prices<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prices<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> prices<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>parseFloat<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>previous<span class="token punctuation">,</span> current<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> current <span class="token operator">></span> previous <span class="token operator">?</span> Trend<span class="token punctuation">.</span>Up <span class="token punctuation">:</span> Trend<span class="token punctuation">.</span>Down<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>trend$ <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>trend$<span class="token punctuation">,</span> timer$<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This component is a little bit more complex so we may want to break this down. Our goal is to:</p>
<ul>
<li> display a red price when a price goes down</li>
<li>display a green price when the price goes up</li>
<li>return the price to a normal state (white) after 2 seconds</li>
</ul>
<p>This is what happens:</p>
<ul>
<li>we get a price via the facade method <code class="language-text">getPriceForAsset</code> and we simply map to its formatted version</li>
<li>we store in memory the latest price received with <code class="language-text">shareReplay(1)</code> so we can reuse the subscription to calculate the trend</li>
<li>every time we get a new price, we create a timer that maps the price state to <code class="language-text">Stale</code> </li>
<li>we use the operator <code class="language-text">pairwise</code> that gives us the current and the previous value for the current subscription, and thanks to that we can figure out if the price went up or down</li>
<li>The trend is an observable emitted when a price changes, and is obtained by merging the timer and the trend result. Every time we have a price change, it first becomes red or green, and then goes back to its normal state after 2 seconds when the observable <code class="language-text">timer$</code> emits a value</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>price-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span>
         <span class="token attr-name">*ngIf</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(price$ | async) as price; else showEmptyState<span class="token punctuation">"</span></span>
         <span class="token attr-name">[ngClass]</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{
            'trend-up': (trend$ | async) === trends.Up,
            'trend-down': (trend$ | async) === trends.Down
         }<span class="token punctuation">"</span></span>
    <span class="token punctuation">></span></span>
        ${{ price }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ng-template</span> <span class="token attr-name">#showEmptyState</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mat-spinner</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mat-spinner</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ng-template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p>The template is very simply the price obtained by the store, replaced by a spinner while the price is undefined, meaning the subscription is still ongoing. </p>
<p>The classes <code class="language-text">trend-up</code> and <code class="language-text">trend-down</code> are added to style the price’s color.</p>
<h2 id="final-words"><a href="#final-words" aria-label="final words permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Final words</h2>
<p>NGRX is a very powerful tool. Certainly, sometimes it may require some in-depth knowledge of RxJS, but with a little bit of patience, it can really revolutionize the way you’ve been writing software. </p>
<p>I hope this tutorial has helped you understand how to set up a basic (yet scalable) folder structure and the basics to start writing powerful reactive applications with Angular and NGRX.</p>
<p>For any clarifications or if there are things you’d do differently, feel free to send me an email or comment below.</p>
<h3 id="source-code"><a href="#source-code" aria-label="source code permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Source Code</h3>
<p>The full source code of the project can be seen at <a href="https://medium.com/r/?url=https%3A%2F%2Fgithub.com%2FGbuomprisco%2Fcryptofolio" target="_blank" rel="nofollow noopener noreferrer">https://github.com/Gbuomprisco/cryptofolio</a></p>
<hr>
<p>Hope you enjoyed the article and leave a message if you agree, disagree, or if you would do anything differently!</p>
<hr>
<p><em>If you enjoyed this article, follow me on</em> <a href="https://medium.com/@.gc" target="_blank" rel="nofollow noopener noreferrer"><em>Medium</em></a> <em>or</em> <a href="https://medium.com/r/?url=https%3A%2F%2Ftwitter.com%2Fhome" target="_blank" rel="nofollow noopener noreferrer"><em>Twitter</em></a> <em>for more articles about Angular, RxJS, Typescript and more!</em></p></div><div class="PrevNext__Wrapper-a8usab-0 dstUWH"><div class="PrevNext__Next-a8usab-2 VLDzk"><span>Next</span><a href="/why-youll-love-typescripts-readonly-array">Why you&#x27;ll love Typescript&#x27;s ReadonlyArray</a></div></div></div></div><footer class="Layout__Footer-sc-1883uv5-0 bULfeK"><a href="https://frontend.consulting/rss.xml" target="_blank"><img src="/images/rss.png" alt="RSS" width="25" height="auto"/></a><a href="https://github.com/fe-consulting" target="_blank"><img src="/images/github.png" alt="Github" width="25" height="auto"/></a><a href="https://www.linkedin.com/company/frontend-consulting-ltd/" target="_blank"><img src="/images/linkedin-logo.png" alt="Linkedin" width="25" height="auto"/></a></footer><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-137411414-1"></script></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-js","jsonName":"abstracting-state-with-ngrx-facades-01c","path":"/abstracting-state-with-ngrx-facades"};window.dataPath="703/path---abstracting-state-with-ngrx-facades-01-c-a5b-Z1xqaoX8mN4KtNbY84ry0o23aA";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e90d4623df6422be07b9.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-778ac4e85441ad17c99f.js"],"component---src-templates-post-js":["/component---src-templates-post-js-1d33f3440efcc6e0648b.js"],"component---src-pages-index-js":["/component---src-pages-index-js-449a323123bd44839177.js"],"component---src-templates-category-js":["/component---src-templates-category-js-a0a040d4b64b82cac006.js"],"component---src-pages-articles-js":["/component---src-pages-articles-js-3faa65281e6ee2078773.js"],"component---src-pages-categories-js":["/component---src-pages-categories-js-8c67115cf578ad11aac1.js"],"component---src-pages-success-js":["/component---src-pages-success-js-afdf76d446c78e9ace9d.js"],"pages-manifest":["/pages-manifest-8da20783ecec21964d53.js"]};/*]]>*/</script><script src="/component---src-templates-post-js-1d33f3440efcc6e0648b.js" async=""></script><script src="/0-018b23dab0eba863196b.js" async=""></script><script src="/styles-946161ed1295301d6b25.js" async=""></script><script src="/app-e90d4623df6422be07b9.js" async=""></script><script src="/webpack-runtime-139a1d28608ef417313a.js" async=""></script></body></html>